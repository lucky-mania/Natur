<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acompanhamento de Progresso - Academia Natur</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="assets/logo.svg" alt="Natur Logo">
                <span>NATUR</span>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">Início</a></li>
                <li><a href="index.html#about" class="nav-link">Sobre</a></li>
                <li><a href="index.html#plans" class="nav-link">Planos</a></li>
                <li><a href="index.html#instructors" class="nav-link">Instrutores</a></li>
                <li><a href="calculators.html" class="nav-link">Calculadoras</a></li>
                <li><a href="progress.html" class="nav-link active">Progresso</a></li>
                <li><a href="index.html#contact" class="nav-link">Contato</a></li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Header -->
    <section class="progress-header">
        <div class="container">
            <h1>Acompanhamento de Progresso</h1>
            <p>Monitore sua jornada fitness e acompanhe sua evolução</p>
        </div>
    </section>

    <!-- Progress Dashboard -->
    <section class="progress-dashboard">
        <div class="container">
            
            <!-- Quick Stats -->
            <div class="stats-overview">
                <div class="stat-card">
                    <i class="fas fa-calendar-check"></i>
                    <div class="stat-info">
                        <h3 id="total-entries">0</h3>
                        <p>Total de Registros</p>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-chart-line"></i>
                    <div class="stat-info">
                        <h3 id="current-bmi">-</h3>
                        <p>IMC Atual</p>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-weight"></i>
                    <div class="stat-info">
                        <h3 id="weight-change">-</h3>
                        <p>Mudança de Peso</p>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-target"></i>
                    <div class="stat-info">
                        <h3 id="days-tracking">0</h3>
                        <p>Dias de Acompanhamento</p>
                    </div>
                </div>
            </div>

            <!-- Progress Entry Form -->
            <div class="progress-entry">
                <div class="entry-card">
                    <h3><i class="fas fa-plus-circle"></i> Adicionar Nova Medição</h3>
                    <form id="progressForm" class="progress-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="entry-date">Data</label>
                                <input type="date" id="entry-date" required>
                            </div>
                            <div class="form-group">
                                <label for="entry-weight">Peso (kg)</label>
                                <input type="number" id="entry-weight" step="0.1" min="30" max="300" required>
                            </div>
                            <div class="form-group">
                                <label for="entry-height">Altura (cm)</label>
                                <input type="number" id="entry-height" step="0.1" min="100" max="250">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="entry-waist">Cintura (cm)</label>
                                <input type="number" id="entry-waist" step="0.1" min="50" max="200">
                            </div>
                            <div class="form-group">
                                <label for="entry-chest">Peito (cm)</label>
                                <input type="number" id="entry-chest" step="0.1" min="60" max="200">
                            </div>
                            <div class="form-group">
                                <label for="entry-arm">Braço (cm)</label>
                                <input type="number" id="entry-arm" step="0.1" min="20" max="80">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="entry-thigh">Coxa (cm)</label>
                                <input type="number" id="entry-thigh" step="0.1" min="30" max="100">
                            </div>
                            <div class="form-group">
                                <label for="entry-bodyfat">Gordura Corporal (%)</label>
                                <input type="number" id="entry-bodyfat" step="0.1" min="5" max="50">
                            </div>
                            <div class="form-group">
                                <label for="entry-notes">Observações</label>
                                <input type="text" id="entry-notes" placeholder="Ex: Início do treino de força">
                            </div>
                        </div>
                        <button type="submit" class="add-entry-btn">
                            <i class="fas fa-plus"></i> Adicionar Registro
                        </button>
                    </form>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="charts-section">
                <div class="chart-container">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-line"></i> Evolução do Peso</h3>
                        <div class="chart-controls">
                            <select id="weightTimeRange">
                                <option value="30">Últimos 30 dias</option>
                                <option value="90">Últimos 3 meses</option>
                                <option value="180">Últimos 6 meses</option>
                                <option value="365">Último ano</option>
                                <option value="all">Todos os dados</option>
                            </select>
                        </div>
                    </div>
                    <canvas id="weightChart"></canvas>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h3><i class="fas fa-percentage"></i> IMC e Gordura Corporal</h3>
                    </div>
                    <canvas id="compositionChart"></canvas>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h3><i class="fas fa-ruler"></i> Medidas Corporais</h3>
                        <div class="chart-controls">
                            <label>
                                <input type="checkbox" id="showWaist" checked> Cintura
                            </label>
                            <label>
                                <input type="checkbox" id="showChest" checked> Peito
                            </label>
                            <label>
                                <input type="checkbox" id="showArm" checked> Braço
                            </label>
                            <label>
                                <input type="checkbox" id="showThigh" checked> Coxa
                            </label>
                        </div>
                    </div>
                    <canvas id="measurementsChart"></canvas>
                </div>
            </div>

            <!-- Progress History -->
            <div class="progress-history">
                <div class="history-header">
                    <h3><i class="fas fa-history"></i> Histórico de Progresso</h3>
                    <div class="history-actions">
                        <button id="exportData" class="export-btn">
                            <i class="fas fa-download"></i> Exportar Dados
                        </button>
                        <button id="generateReport" class="report-btn">
                            <i class="fas fa-file-pdf"></i> Gerar Relatório PDF
                        </button>
                        <button id="clearData" class="clear-btn">
                            <i class="fas fa-trash"></i> Limpar Dados
                        </button>
                    </div>
                </div>
                
                <div class="history-table-container">
                    <table id="progressTable" class="progress-table">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Peso (kg)</th>
                                <th>IMC</th>
                                <th>Cintura (cm)</th>
                                <th>Gordura (%)</th>
                                <th>Observações</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="progressTableBody">
                            <!-- Progress entries will be inserted here -->
                        </tbody>
                    </table>
                    
                    <div id="emptyState" class="empty-state" style="display: none;">
                        <i class="fas fa-chart-line"></i>
                        <h4>Nenhum registro encontrado</h4>
                        <p>Adicione sua primeira medição para começar a acompanhar seu progresso!</p>
                    </div>
                </div>
            </div>

            <!-- Progress Goals -->
            <div class="progress-goals">
                <div class="goals-card">
                    <h3><i class="fas fa-bullseye"></i> Definir Metas</h3>
                    <form id="goalsForm" class="goals-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="goal-weight">Meta de Peso (kg)</label>
                                <input type="number" id="goal-weight" step="0.1" min="30" max="300">
                            </div>
                            <div class="form-group">
                                <label for="goal-bodyfat">Meta de Gordura Corporal (%)</label>
                                <input type="number" id="goal-bodyfat" step="0.1" min="5" max="50">
                            </div>
                            <div class="form-group">
                                <label for="goal-date">Data Alvo</label>
                                <input type="date" id="goal-date">
                            </div>
                        </div>
                        <button type="submit" class="save-goals-btn">
                            <i class="fas fa-save"></i> Salvar Metas
                        </button>
                    </form>
                    
                    <div id="goalsDisplay" class="goals-display" style="display: none;">
                        <h4>Suas Metas Atuais:</h4>
                        <div class="goal-item">
                            <span>Peso:</span>
                            <span id="displayGoalWeight">-</span>
                        </div>
                        <div class="goal-item">
                            <span>Gordura Corporal:</span>
                            <span id="displayGoalBodyfat">-</span>
                        </div>
                        <div class="goal-item">
                            <span>Data Alvo:</span>
                            <span id="displayGoalDate">-</span>
                        </div>
                        <div class="goal-progress">
                            <h5>Progresso para a Meta:</h5>
                            <div class="progress-bar">
                                <div class="progress-fill" id="goalProgressBar" style="width: 0%"></div>
                            </div>
                            <span id="goalProgressText">0% alcançado</span>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo">
                        <img src="assets/logo.svg" alt="Natur Logo">
                        <span>NATUR</span>
                    </div>
                    <p>Transforme seu corpo, transforme sua vida.</p>
                </div>
                <div class="footer-section">
                    <h4>Links Rápidos</h4>
                    <ul>
                        <li><a href="index.html">Início</a></li>
                        <li><a href="index.html#about">Sobre</a></li>
                        <li><a href="index.html#plans">Planos</a></li>
                        <li><a href="calculators.html">Calculadoras</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contato</h4>
                    <p><i class="fas fa-map-marker-alt"></i> Av. Ministro A Petrônio Portela, 86</p>
                    <p><i class="fas fa-phone"></i> (86) 98112-64546</p>
                </div>
                <div class="footer-section">
                    <h4>Redes Sociais</h4>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Academia Natur. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        // Progress tracking functionality
        document.addEventListener('DOMContentLoaded', function() {
            let progressData = JSON.parse(localStorage.getItem('naturProgressData') || '[]');
            let goalsData = JSON.parse(localStorage.getItem('naturGoalsData') || '{}');
            let weightChart, compositionChart, measurementsChart;

            // Initialize page
            initializeCharts();
            loadProgressData();
            loadGoalsData();
            updateStats();
            
            // Set default date to today
            document.getElementById('entry-date').value = new Date().toISOString().split('T')[0];

            // Progress form submission
            document.getElementById('progressForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = {
                    date: document.getElementById('entry-date').value,
                    weight: parseFloat(document.getElementById('entry-weight').value),
                    height: parseFloat(document.getElementById('entry-height').value) || null,
                    waist: parseFloat(document.getElementById('entry-waist').value) || null,
                    chest: parseFloat(document.getElementById('entry-chest').value) || null,
                    arm: parseFloat(document.getElementById('entry-arm').value) || null,
                    thigh: parseFloat(document.getElementById('entry-thigh').value) || null,
                    bodyfat: parseFloat(document.getElementById('entry-bodyfat').value) || null,
                    notes: document.getElementById('entry-notes').value || '',
                    timestamp: new Date().toISOString()
                };

                // Calculate BMI if height is provided
                if (formData.height) {
                    const heightM = formData.height / 100;
                    formData.bmi = formData.weight / (heightM * heightM);
                }

                // Check if entry for this date already exists
                const existingEntryIndex = progressData.findIndex(entry => entry.date === formData.date);
                if (existingEntryIndex !== -1) {
                    if (confirm('Já existe um registro para esta data. Deseja substituir?')) {
                        progressData[existingEntryIndex] = formData;
                    } else {
                        return;
                    }
                } else {
                    progressData.push(formData);
                }

                // Sort by date
                progressData.sort((a, b) => new Date(a.date) - new Date(b.date));
                
                saveProgressData();
                loadProgressData();
                updateStats();
                updateCharts();
                
                // Reset form
                this.reset();
                document.getElementById('entry-date').value = new Date().toISOString().split('T')[0];
                
                alert('Registro adicionado com sucesso!');
            });

            // Goals form submission
            document.getElementById('goalsForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                goalsData = {
                    weight: parseFloat(document.getElementById('goal-weight').value) || null,
                    bodyfat: parseFloat(document.getElementById('goal-bodyfat').value) || null,
                    date: document.getElementById('goal-date').value || null,
                    setDate: new Date().toISOString()
                };

                saveGoalsData();
                loadGoalsData();
                alert('Metas salvas com sucesso!');
            });

            // Export data
            document.getElementById('exportData').addEventListener('click', function() {
                const dataStr = JSON.stringify(progressData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `natur-progress-data-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
            });

            // Generate PDF report
            document.getElementById('generateReport').addEventListener('click', function() {
                if (progressData.length === 0) {
                    alert('Nenhum dado de progresso encontrado para gerar relatório.');
                    return;
                }
                generateProgressReport();
            });

            // Clear data
            document.getElementById('clearData').addEventListener('click', function() {
                if (confirm('Tem certeza que deseja limpar todos os dados? Esta ação não pode ser desfeita.')) {
                    progressData = [];
                    goalsData = {};
                    saveProgressData();
                    saveGoalsData();
                    loadProgressData();
                    loadGoalsData();
                    updateStats();
                    updateCharts();
                    alert('Dados limpos com sucesso!');
                }
            });

            // Chart controls
            document.getElementById('weightTimeRange').addEventListener('change', updateCharts);
            document.getElementById('showWaist').addEventListener('change', updateCharts);
            document.getElementById('showChest').addEventListener('change', updateCharts);
            document.getElementById('showArm').addEventListener('change', updateCharts);
            document.getElementById('showThigh').addEventListener('change', updateCharts);

            function saveProgressData() {
                localStorage.setItem('naturProgressData', JSON.stringify(progressData));
            }

            function saveGoalsData() {
                localStorage.setItem('naturGoalsData', JSON.stringify(goalsData));
            }

            function loadProgressData() {
                const tableBody = document.getElementById('progressTableBody');
                const emptyState = document.getElementById('emptyState');
                
                if (progressData.length === 0) {
                    tableBody.innerHTML = '';
                    emptyState.style.display = 'block';
                    return;
                }

                emptyState.style.display = 'none';
                tableBody.innerHTML = '';

                progressData.slice().reverse().forEach((entry, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${new Date(entry.date).toLocaleDateString('pt-BR')}</td>
                        <td>${entry.weight.toFixed(1)}</td>
                        <td>${entry.bmi ? entry.bmi.toFixed(1) : '-'}</td>
                        <td>${entry.waist ? entry.waist.toFixed(1) : '-'}</td>
                        <td>${entry.bodyfat ? entry.bodyfat.toFixed(1) + '%' : '-'}</td>
                        <td class="notes-cell">${entry.notes || '-'}</td>
                        <td>
                            <button class="delete-entry" data-date="${entry.date}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });

                // Add delete functionality
                document.querySelectorAll('.delete-entry').forEach(button => {
                    button.addEventListener('click', function() {
                        const date = this.dataset.date;
                        if (confirm('Tem certeza que deseja excluir este registro?')) {
                            progressData = progressData.filter(entry => entry.date !== date);
                            saveProgressData();
                            loadProgressData();
                            updateStats();
                            updateCharts();
                        }
                    });
                });
            }

            function loadGoalsData() {
                const goalsDisplay = document.getElementById('goalsDisplay');
                const goalsForm = document.getElementById('goalsForm');

                if (Object.keys(goalsData).length === 0) {
                    goalsDisplay.style.display = 'none';
                    return;
                }

                // Populate form
                if (goalsData.weight) document.getElementById('goal-weight').value = goalsData.weight;
                if (goalsData.bodyfat) document.getElementById('goal-bodyfat').value = goalsData.bodyfat;
                if (goalsData.date) document.getElementById('goal-date').value = goalsData.date;

                // Update display
                document.getElementById('displayGoalWeight').textContent = goalsData.weight ? goalsData.weight + ' kg' : '-';
                document.getElementById('displayGoalBodyfat').textContent = goalsData.bodyfat ? goalsData.bodyfat + '%' : '-';
                document.getElementById('displayGoalDate').textContent = goalsData.date ? new Date(goalsData.date).toLocaleDateString('pt-BR') : '-';

                // Calculate progress
                updateGoalProgress();
                goalsDisplay.style.display = 'block';
            }

            function updateGoalProgress() {
                if (progressData.length === 0 || !goalsData.weight) return;

                const latestEntry = progressData[progressData.length - 1];
                const startWeight = progressData[0].weight;
                const currentWeight = latestEntry.weight;
                const goalWeight = goalsData.weight;

                const totalChange = Math.abs(goalWeight - startWeight);
                const currentChange = Math.abs(currentWeight - startWeight);
                const progress = Math.min(100, (currentChange / totalChange) * 100);

                document.getElementById('goalProgressBar').style.width = progress + '%';
                document.getElementById('goalProgressText').textContent = progress.toFixed(1) + '% alcançado';
            }

            function updateStats() {
                document.getElementById('total-entries').textContent = progressData.length;
                
                if (progressData.length === 0) {
                    document.getElementById('current-bmi').textContent = '-';
                    document.getElementById('weight-change').textContent = '-';
                    document.getElementById('days-tracking').textContent = '0';
                    return;
                }

                const latestEntry = progressData[progressData.length - 1];
                const firstEntry = progressData[0];

                // Current BMI
                if (latestEntry.bmi) {
                    document.getElementById('current-bmi').textContent = latestEntry.bmi.toFixed(1);
                } else {
                    document.getElementById('current-bmi').textContent = '-';
                }

                // Weight change
                const weightChange = latestEntry.weight - firstEntry.weight;
                const weightChangeText = weightChange >= 0 ? '+' + weightChange.toFixed(1) : weightChange.toFixed(1);
                document.getElementById('weight-change').textContent = weightChangeText + ' kg';

                // Days tracking
                const daysDiff = Math.ceil((new Date(latestEntry.date) - new Date(firstEntry.date)) / (1000 * 60 * 60 * 24));
                document.getElementById('days-tracking').textContent = daysDiff;
            }

            function initializeCharts() {
                const chartOptions = {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        x: {
                            type: 'time',
                            time: {
                                unit: 'day'
                            }
                        }
                    }
                };

                // Weight Chart
                const weightCtx = document.getElementById('weightChart').getContext('2d');
                weightChart = new Chart(weightCtx, {
                    type: 'line',
                    data: {
                        datasets: [{
                            label: 'Peso (kg)',
                            data: [],
                            borderColor: 'hsl(210, 100%, 45%)',
                            backgroundColor: 'hsla(210, 100%, 45%, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: chartOptions
                });

                // Composition Chart
                const compositionCtx = document.getElementById('compositionChart').getContext('2d');
                compositionChart = new Chart(compositionCtx, {
                    type: 'line',
                    data: {
                        datasets: [
                            {
                                label: 'IMC',
                                data: [],
                                borderColor: 'hsl(210, 100%, 45%)',
                                backgroundColor: 'hsla(210, 100%, 45%, 0.1)',
                                yAxisID: 'y',
                                tension: 0.4
                            },
                            {
                                label: 'Gordura Corporal (%)',
                                data: [],
                                borderColor: 'hsl(0, 0%, 15%)',
                                backgroundColor: 'hsla(0, 0%, 15%, 0.1)',
                                yAxisID: 'y1',
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        ...chartOptions,
                        scales: {
                            ...chartOptions.scales,
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                grid: {
                                    drawOnChartArea: false,
                                }
                            }
                        }
                    }
                });

                // Measurements Chart
                const measurementsCtx = document.getElementById('measurementsChart').getContext('2d');
                measurementsChart = new Chart(measurementsCtx, {
                    type: 'line',
                    data: {
                        datasets: [
                            {
                                label: 'Cintura (cm)',
                                data: [],
                                borderColor: 'hsl(210, 100%, 45%)',
                                backgroundColor: 'hsla(210, 100%, 45%, 0.1)',
                                tension: 0.4
                            },
                            {
                                label: 'Peito (cm)',
                                data: [],
                                borderColor: 'hsl(210, 100%, 25%)',
                                backgroundColor: 'hsla(210, 100%, 25%, 0.1)',
                                tension: 0.4
                            },
                            {
                                label: 'Braço (cm)',
                                data: [],
                                borderColor: 'hsl(0, 0%, 15%)',
                                backgroundColor: 'hsla(0, 0%, 15%, 0.1)',
                                tension: 0.4
                            },
                            {
                                label: 'Coxa (cm)',
                                data: [],
                                borderColor: 'hsl(0, 0%, 30%)',
                                backgroundColor: 'hsla(0, 0%, 30%, 0.1)',
                                tension: 0.4
                            }
                        ]
                    },
                    options: chartOptions
                });

                updateCharts();
            }

            function updateCharts() {
                if (progressData.length === 0) return;

                // Filter data based on time range
                const timeRange = parseInt(document.getElementById('weightTimeRange').value);
                let filteredData = progressData;
                
                if (timeRange !== 'all') {
                    const cutoffDate = new Date();
                    cutoffDate.setDate(cutoffDate.getDate() - timeRange);
                    filteredData = progressData.filter(entry => new Date(entry.date) >= cutoffDate);
                }

                // Update weight chart
                weightChart.data.datasets[0].data = filteredData.map(entry => ({
                    x: entry.date,
                    y: entry.weight
                }));
                weightChart.update();

                // Update composition chart
                compositionChart.data.datasets[0].data = filteredData
                    .filter(entry => entry.bmi)
                    .map(entry => ({
                        x: entry.date,
                        y: entry.bmi
                    }));
                
                compositionChart.data.datasets[1].data = filteredData
                    .filter(entry => entry.bodyfat)
                    .map(entry => ({
                        x: entry.date,
                        y: entry.bodyfat
                    }));
                compositionChart.update();

                // Update measurements chart
                const measurements = ['waist', 'chest', 'arm', 'thigh'];
                const checkboxes = ['showWaist', 'showChest', 'showArm', 'showThigh'];
                
                measurements.forEach((measurement, index) => {
                    const isVisible = document.getElementById(checkboxes[index]).checked;
                    const dataset = measurementsChart.data.datasets[index];
                    
                    if (isVisible) {
                        dataset.data = filteredData
                            .filter(entry => entry[measurement])
                            .map(entry => ({
                                x: entry.date,
                                y: entry[measurement]
                            }));
                    } else {
                        dataset.data = [];
                    }
                });
                measurementsChart.update();
            }

            function generateProgressReport() {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Header
                doc.setFontSize(20);
                doc.setTextColor(33, 150, 243);
                doc.text('Academia Natur', 20, 20);
                doc.setFontSize(16);
                doc.setTextColor(0, 0, 0);
                doc.text('Relatório de Progresso Fitness', 20, 30);
                
                // Date range
                const startDate = progressData[0].date;
                const endDate = progressData[progressData.length - 1].date;
                doc.setFontSize(12);
                doc.text(`Período: ${new Date(startDate).toLocaleDateString('pt-BR')} - ${new Date(endDate).toLocaleDateString('pt-BR')}`, 20, 45);
                doc.text(`Gerado em: ${new Date().toLocaleString('pt-BR')}`, 20, 55);
                
                let yPosition = 70;
                
                // Statistics
                doc.setFontSize(14);
                doc.setTextColor(33, 150, 243);
                doc.text('Resumo Estatístico', 20, yPosition);
                doc.setFontSize(12);
                doc.setTextColor(0, 0, 0);
                
                const firstEntry = progressData[0];
                const latestEntry = progressData[progressData.length - 1];
                const weightChange = latestEntry.weight - firstEntry.weight;
                
                yPosition += 15;
                doc.text(`Total de registros: ${progressData.length}`, 20, yPosition);
                yPosition += 10;
                doc.text(`Peso inicial: ${firstEntry.weight.toFixed(1)} kg`, 20, yPosition);
                yPosition += 10;
                doc.text(`Peso atual: ${latestEntry.weight.toFixed(1)} kg`, 20, yPosition);
                yPosition += 10;
                doc.text(`Mudança de peso: ${weightChange >= 0 ? '+' : ''}${weightChange.toFixed(1)} kg`, 20, yPosition);
                
                if (latestEntry.bmi) {
                    yPosition += 10;
                    doc.text(`IMC atual: ${latestEntry.bmi.toFixed(1)}`, 20, yPosition);
                }
                
                if (latestEntry.bodyfat) {
                    yPosition += 10;
                    doc.text(`Gordura corporal atual: ${latestEntry.bodyfat.toFixed(1)}%`, 20, yPosition);
                }
                
                yPosition += 20;
                
                // Goals section
                if (Object.keys(goalsData).length > 0) {
                    doc.setFontSize(14);
                    doc.setTextColor(33, 150, 243);
                    doc.text('Metas Definidas', 20, yPosition);
                    doc.setFontSize(12);
                    doc.setTextColor(0, 0, 0);
                    
                    yPosition += 15;
                    if (goalsData.weight) {
                        doc.text(`Meta de peso: ${goalsData.weight} kg`, 20, yPosition);
                        yPosition += 10;
                    }
                    if (goalsData.bodyfat) {
                        doc.text(`Meta de gordura corporal: ${goalsData.bodyfat}%`, 20, yPosition);
                        yPosition += 10;
                    }
                    if (goalsData.date) {
                        doc.text(`Data alvo: ${new Date(goalsData.date).toLocaleDateString('pt-BR')}`, 20, yPosition);
                        yPosition += 10;
                    }
                }
                
                // Recent entries table
                yPosition += 10;
                doc.setFontSize(14);
                doc.setTextColor(33, 150, 243);
                doc.text('Últimas Medições', 20, yPosition);
                
                yPosition += 15;
                doc.setFontSize(10);
                doc.setTextColor(0, 0, 0);
                
                // Table headers
                doc.text('Data', 20, yPosition);
                doc.text('Peso', 60, yPosition);
                doc.text('IMC', 90, yPosition);
                doc.text('Cintura', 120, yPosition);
                doc.text('Gordura', 150, yPosition);
                doc.text('Observações', 180, yPosition);
                
                yPosition += 10;
                
                // Table data (last 10 entries)
                const recentEntries = progressData.slice(-10);
                recentEntries.forEach(entry => {
                    if (yPosition > 270) {
                        doc.addPage();
                        yPosition = 20;
                    }
                    
                    doc.text(new Date(entry.date).toLocaleDateString('pt-BR'), 20, yPosition);
                    doc.text(`${entry.weight.toFixed(1)}`, 60, yPosition);
                    doc.text(entry.bmi ? entry.bmi.toFixed(1) : '-', 90, yPosition);
                    doc.text(entry.waist ? `${entry.waist.toFixed(1)}` : '-', 120, yPosition);
                    doc.text(entry.bodyfat ? `${entry.bodyfat.toFixed(1)}%` : '-', 150, yPosition);
                    doc.text(entry.notes ? entry.notes.substring(0, 15) + '...' : '-', 180, yPosition);
                    
                    yPosition += 10;
                });
                
                // Footer
                doc.setFontSize(10);
                doc.setTextColor(128, 128, 128);
                doc.text('Academia Natur - Av. Ministro A Petrônio Portela, 86', 20, 280);
                doc.text('Telefone: (86) 98112-64546', 20, 290);
                
                // Save PDF
                doc.save(`relatorio-progresso-natur-${new Date().toISOString().split('T')[0]}.pdf`);
            }
        });
    </script>

    <style>
        .progress-header {
            background: var(--gradient);
            color: var(--white);
            padding: 120px 0 80px;
            text-align: center;
        }

        .progress-header h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .progress-header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .progress-dashboard {
            padding: 80px 0;
            background: var(--light-gray);
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: var(--white);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card i {
            font-size: 2.5rem;
            color: var(--primary-blue);
        }

        .stat-info h3 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: var(--dark-blue);
        }

        .stat-info p {
            color: var(--medium-gray);
            margin: 0;
        }

        .progress-entry {
            margin-bottom: 3rem;
        }

        .entry-card {
            background: var(--white);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .entry-card h3 {
            color: var(--dark-blue);
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .entry-card h3 i {
            color: var(--primary-blue);
        }

        .progress-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: var(--dark-blue);
        }

        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .add-entry-btn {
            padding: 15px 30px;
            background: var(--primary-blue);
            color: var(--white);
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            justify-content: center;
        }

        .add-entry-btn:hover {
            background: var(--dark-blue);
        }

        .charts-section {
            margin-bottom: 3rem;
        }

        .chart-container {
            background: var(--white);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .chart-header h3 {
            color: var(--dark-blue);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .chart-header h3 i {
            color: var(--primary-blue);
        }

        .chart-controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .chart-controls select {
            padding: 8px 12px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
        }

        .chart-controls label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--medium-gray);
        }

        #weightChart,
        #compositionChart,
        #measurementsChart {
            height: 300px;
        }

        .progress-history {
            margin-bottom: 3rem;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .history-header h3 {
            color: var(--dark-blue);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .history-header h3 i {
            color: var(--primary-blue);
        }

        .history-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .export-btn,
        .report-btn,
        .clear-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .export-btn {
            background: var(--primary-blue);
            color: var(--white);
        }

        .export-btn:hover {
            background: var(--dark-blue);
        }

        .report-btn {
            background: var(--dark-blue);
            color: var(--white);
        }

        .report-btn:hover {
            background: var(--medium-gray);
        }

        .clear-btn {
            background: var(--medium-gray);
            color: var(--white);
        }

        .clear-btn:hover {
            background: #e74c3c;
        }

        .history-table-container {
            background: var(--white);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .progress-table {
            width: 100%;
            border-collapse: collapse;
        }

        .progress-table th,
        .progress-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--light-gray);
        }

        .progress-table th {
            background: var(--light-gray);
            color: var(--dark-blue);
            font-weight: bold;
        }

        .progress-table tr:hover {
            background: var(--light-gray);
        }

        .notes-cell {
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .delete-entry {
            background: #e74c3c;
            color: var(--white);
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .delete-entry:hover {
            background: #c0392b;
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--medium-gray);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            color: var(--primary-blue);
            opacity: 0.5;
        }

        .empty-state h4 {
            margin-bottom: 1rem;
            color: var(--dark-blue);
        }

        .progress-goals {
            margin-bottom: 3rem;
        }

        .goals-card {
            background: var(--white);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .goals-card h3 {
            color: var(--dark-blue);
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .goals-card h3 i {
            color: var(--primary-blue);
        }

        .goals-form {
            margin-bottom: 2rem;
        }

        .save-goals-btn {
            padding: 12px 20px;
            background: var(--primary-blue);
            color: var(--white);
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .save-goals-btn:hover {
            background: var(--dark-blue);
        }

        .goals-display {
            background: var(--light-gray);
            padding: 1.5rem;
            border-radius: 10px;
            border-left: 4px solid var(--primary-blue);
        }

        .goals-display h4 {
            margin-bottom: 1rem;
            color: var(--dark-blue);
        }

        .goal-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .goal-item span:first-child {
            font-weight: bold;
            color: var(--medium-gray);
        }

        .goal-item span:last-child {
            color: var(--dark-blue);
        }

        .goal-progress {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--light-gray);
        }

        .goal-progress h5 {
            margin-bottom: 0.5rem;
            color: var(--dark-blue);
        }

        .progress-bar {
            background: var(--light-gray);
            border-radius: 10px;
            height: 10px;
            margin-bottom: 0.5rem;
            overflow: hidden;
        }

        .progress-fill {
            background: var(--primary-blue);
            height: 100%;
            transition: width 0.3s ease;
        }

        .nav-link.active {
            color: var(--primary-blue);
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .progress-header h1 {
                font-size: 2rem;
            }

            .stats-overview {
                grid-template-columns: 1fr;
            }

            .stat-card {
                flex-direction: column;
                text-align: center;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .chart-header {
                flex-direction: column;
                align-items: stretch;
            }

            .chart-controls {
                justify-content: center;
            }

            .history-header {
                flex-direction: column;
                align-items: stretch;
            }

            .history-actions {
                justify-content: center;
            }

            .progress-table {
                font-size: 0.8rem;
            }

            .progress-table th,
            .progress-table td {
                padding: 10px 5px;
            }

            .notes-cell {
                max-width: 80px;
            }
        }
    </style>
</body>
</html>
